<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/app-storage/app-localstorage/app-localstorage-document.html">
<link rel="import" href="/app/elements/htwg-iconset.html">
<link rel="import" href="/app/elements/htwg-navbar.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="/bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="/bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="/bower_components/paper-item/paper-item.html">

<dom-module name="container-select" attributes="url title">
	<style>
       select {
            border: 3px solid var(--weather-primary-color);

            background: white url(../svg/pfeil.svg) no-repeat right; 
            font-size: 13pt;
            font-weight: bold;
            width: 100%;
            text-indent: 0.01px;
            text-overflow: "";
            color: var(--weather-primary-color);
            padding: 5px;
            outline: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        } 
        
    /*    paper-dropdown-menu.custom {
            border:3px solid var(--weather-primary-color);
            --paper-input-container-label: {
            };
            --paper-input-container-input: {
            color: var(--weather-primary-color);

            }
    
        }
        
    }
    </style>

   	<template>
    <!--
    <paper-dropdown-menu id="menu" class="custom" label="[[title]]" no-label-float>
            <paper-listbox id="select"class="dropdown-content">
                    <template is="dom-repeat" items="[[items]]" as="item">
                        <paper-item value="[[item.name]]">[[item.value]]</paper-item>
                    </template>
            </paper-listbox>
        </paper-dropdown-menu>
    -->
		<select id="select" on-change="valueSelected">
			<option>[[title]]</option>
        	<template is="dom-repeat" items="[[items]]" as="item">
    			<option value="[[item.name]]">[[item.value]]</option>
			</template>
		</select>
 		<iron-ajax auto url="[[url]]" handle-as="json" on-response="setContent"></iron-ajax>
 	</template>

 	<script type="text/javascript">
 	 Polymer({
        is: "container-select",
        properties: {
        	url: String,
        	title: String,
           	items: Array,
           	value: String
        },
      listeners: {
                "iron-select": "valueSelected",
            },
        ready: function() {},

 		setContent: function(e,d){
 			this.data = d.response;
			this.setItems(this.data);
 		},
 		setItems: function(items) {
            console.log(items);
 			this.items = this.toArray(items);
 		},
 		valueSelected: function() {
 			this.value= this.$.select.selectedItem.value;
            console.log(this.value);
            this.fire('valueSelected');
 		},
 		toArray: function(obj){
 			return Object.keys(obj).map(function(key) {
                return {
                    name: key,
                    value: obj[key]
                }
            });
        },
    });

 	</script>